<!DOCTYPE html>
<html>
<head>
    <title>Lockpick to Cookie Bot</title>
</head>
<body>
Lockpick titles.keys: <input type="file" id="lockpick" name="lockpick" /><br>
<div id="resultDiv" style="display:none;">
    <textarea id="result" style="width: 100%;"></textarea>
</div>
<script type="text/javascript">
function handleFileSelect(event) {
    let files = event.target.files; // FileList object
    let reader = new FileReader();

  // Closure to capture the file information and read it.
    reader.onload = (function(theFile) {
        return function(e) {
            if (! theFile.name.toLowerCase().match(/titles?.keys/i)) {
                alert('You must upload a title.keys from Lockpick!');
                return;
            }
            let contents = e.target.result.split(/\n/);
            let result = [];
            for (var i=0; i < contents.length; i++) {
                result.push(contents[i].substr(0, 16));
            }
            document.getElementById('resultDiv').style.display = '';
            document.getElementById('result').value = "g!sub " + result.join(', ');
        };
    })(files[0]);
    reader.readAsText(files[0]);
}

document.getElementById('lockpick').addEventListener('change', handleFileSelect, false);
</script>
</body>
</html>